<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#f0eee9" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#252525" media="(prefers-color-scheme: dark)">
    <meta name="description" content="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π –ú–ö–ù–º-241">
    <title>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ú–ö–ù–º-241</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --mocha-mousse: #A47864;
            --mocha-light: #C0A294;
            --mocha-dark: #8B6354;
            --cloud-dancer: #f0eee9;
            --bg-base: #f5f5f5;
            --bg-surface: #ffffff;
            --bg-elevated: #f0efeb;
            --text-primary: #252525;
            --text-secondary: #6F6F6F;
            --text-tertiary: #8D8D8D;
            --border-color: #E0E0E0;
            --border-light: #C6C6C6;
            
            --space-xs: 0.375rem;
            --space-sm: 0.75rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            
            --radius-sm: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
            
            --ease-out: cubic-bezier(0.2, 0.8, 0.4, 1);
            --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
            --duration: 200ms;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-base: #161616;
                --bg-surface: #252525;
                --bg-elevated: #2f2f2f;
                --text-primary: #f0eee9;
                --text-secondary: #a0a0a0;
                --text-tertiary: #6F6F6F;
                --border-color: #3d3d3d;
                --border-light: #4e4e4e;
                --mocha-mousse: #C0A294;
                --mocha-light: #d4bbb0;
                --mocha-dark: #A47864;
                --shadow-sm: 0 1px 4px rgba(0,0,0,0.3);
                --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
                --shadow-lg: 0 8px 24px rgba(0,0,0,0.5);
            }
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        body {
            font-family: var(--font-sans);
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-primary);
            background: var(--bg-base);
            min-height: 100vh;
        }

        .app {
            display: flex;
            flex-direction: column;
            gap: var(--space-xl);
            max-width: 52rem;
            margin: 0 auto;
            padding: var(--space-lg);
            padding-bottom: calc(5rem + env(safe-area-inset-bottom));
        }

        .header {
            animation: fadeSlideIn 0.5s var(--ease-out) both;
        }

        .header__date {
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.02em;
            color: var(--mocha-mousse);
        }

        .week-nav {
            position: fixed;
            bottom: max(env(safe-area-inset-bottom), var(--space-md));
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs);
            background: rgba(255,255,255,0.85);
            backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.4s var(--ease-spring) both;
        }

        @media (prefers-color-scheme: dark) {
            .week-nav {
                background: rgba(37,37,37,0.9);
            }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            height: 2.75rem;
            padding: 0 var(--space-md);
            font-family: inherit;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--duration) var(--ease-out);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .btn--icon {
            width: 2.75rem;
            padding: 0;
        }

        .btn:hover:not(:disabled) {
            color: var(--mocha-mousse);
            background: rgba(164,120,100,0.1);
        }

        .btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .btn--primary {
            min-width: 3.5rem;
            font-weight: 600;
            color: #fff;
            background: var(--mocha-mousse);
        }

        .btn--primary:hover:not(:disabled) {
            background: var(--mocha-dark);
            color: #fff;
        }

        .btn__icon {
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2.5;
        }

        .schedule {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            transition: opacity var(--duration) var(--ease-out);
        }

        .schedule--loading {
            opacity: 0;
        }

        .day-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            animation: fadeSlideIn 0.4s var(--ease-out) both;
            transition: transform var(--duration) var(--ease-out), box-shadow var(--duration) var(--ease-out);
        }

        .day-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .day-card__header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-md);
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--text-primary);
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border-color);
        }

        .day-card__header::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--mocha-mousse);
            border-radius: 50%;
            flex-shrink: 0;
        }

        .day-card--today .day-card__header {
            background: linear-gradient(135deg, rgba(164,120,100,0.15), rgba(192,162,148,0.1));
        }

        .day-card--today .day-card__header::before {
            box-shadow: 0 0 0 3px rgba(164,120,100,0.3);
        }

        .lesson {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
            padding: var(--space-md);
            color: inherit;
            text-decoration: none;
            border-bottom: 1px solid var(--border-color);
            transition: background var(--duration) var(--ease-out);
        }

        .lesson:last-child {
            border-bottom: none;
        }

        a.lesson:hover {
            background: rgba(164,120,100,0.08);
        }

        .lesson__time {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--text-tertiary);
        }

        .lesson__icon {
            width: 0.875rem;
            height: 0.875rem;
            color: var(--mocha-mousse);
        }

        .lesson__title {
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--text-primary);
            line-height: 1.4;
        }

        a.lesson:hover .lesson__title {
            color: var(--mocha-mousse);
        }

        .lesson__meta {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-sm);
        }

        .lesson__tag {
            padding: 0.2rem var(--space-sm);
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--mocha-mousse);
            background: rgba(164,120,100,0.12);
            border-radius: var(--radius-sm);
        }

        .lesson__teacher {
            font-size: 0.8125rem;
            color: var(--text-secondary);
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-lg);
            padding: var(--space-xl);
            text-align: center;
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            animation: fadeSlideIn 0.4s var(--ease-out) both;
        }

        .empty-state__emoji {
            font-size: 3.5rem;
        }

        .empty-state__title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .empty-state__text {
            font-size: 0.9375rem;
            color: var(--text-secondary);
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateX(-50%) translateY(16px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        .day-card:nth-child(1) { animation-delay: 0.05s; }
        .day-card:nth-child(2) { animation-delay: 0.1s; }
        .day-card:nth-child(3) { animation-delay: 0.15s; }
        .day-card:nth-child(4) { animation-delay: 0.2s; }
        .day-card:nth-child(5) { animation-delay: 0.25s; }
        .day-card:nth-child(6) { animation-delay: 0.3s; }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <h1 class="header__date" id="dateDisplay"></h1>
        </header>
        <main class="schedule" id="schedule"></main>
        <nav class="week-nav" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º">
            <button class="btn btn--icon" id="prevBtn" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è">
                <svg class="btn__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <button class="btn btn--primary" id="resetBtn"><span id="weekNumber"></span></button>
            <button class="btn btn--icon" id="nextBtn" aria-label="–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è">
                <svg class="btn__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
                </svg>
            </button>
        </nav>
    </div>

    <script>
        const CONFIG = Object.freeze({
            MIN_WEEK: 20,
            MAX_WEEK: 39,
            SEMESTER_START: Object.freeze({ month: 8, day: 1 }),
            DAYS: Object.freeze(['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞']),
            MS_PER_WEEK: 604800000
        });

        const SCHEDULE = Object.freeze({
            odd: Object.freeze({
                '–°—Ä–µ–¥–∞': [
                    { time: '15:30 ‚Äì 17:05', name: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã', type: '–õ–µ–∫—Ü–∏—è', teacher: '–∑–∞–≤. –∫–∞—Ñ–µ–¥—Ä–æ–π –ì—É–¥–æ–≤ –ê.–ú.', link: 'https://bbb.kemsu.ru/b/nt9-332-k4x-2pe' },
                    { time: '17:15 ‚Äì 18:50', name: '–ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π', type: '–õ–µ–∫—Ü–∏—è', teacher: '–¥–æ—Ü. –°–∞–±–ª–∏–Ω—Å–∫–∏–π –ê.–ò.' },
                    { time: '19:00 ‚Äì 20:35', name: '–ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π', type: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è', teacher: '–¥–æ—Ü. –°–∞–±–ª–∏–Ω—Å–∫–∏–π –ê.–ò.' }
                ]
            }),
            even: Object.freeze({
                '–°—Ä–µ–¥–∞': [
                    { time: '15:30 ‚Äì 17:05', name: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã', type: '–ü—Ä–∞–∫—Ç–∏–∫–∞', teacher: '–∑–∞–≤. –∫–∞—Ñ–µ–¥—Ä–æ–π –ì—É–¥–æ–≤ –ê.–ú.', link: 'https://bbb.kemsu.ru/b/nt9-332-k4x-2pe' }
                ],
                '–ü—è—Ç–Ω–∏—Ü–∞': [
                    { time: '17:15 ‚Äì 18:50', name: '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –∏ –º–æ–¥–µ–ª–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏', type: '–õ–µ–∫—Ü–∏—è', teacher: '–¥–æ—Ü. –°–µ—Ä–≥–µ–µ–≤–∞ –û.–ê.' },
                    { time: '19:00 ‚Äì 20:35', name: '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –∏ –º–æ–¥–µ–ª–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏', type: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è', teacher: '–¥–æ—Ü. –°–µ—Ä–≥–µ–µ–≤–∞ –û.–ê.' }
                ]
            })
        });

        const getAcademicWeek = (date) => {
            const year = date.getMonth() < CONFIG.SEMESTER_START.month ? date.getFullYear() - 1 : date.getFullYear();
            const start = new Date(year, CONFIG.SEMESTER_START.month, CONFIG.SEMESTER_START.day);
            const dayOffset = (start.getDay() + 6) % 7;
            start.setDate(start.getDate() - dayOffset);
            return Math.ceil((date - start) / CONFIG.MS_PER_WEEK);
        };

        const addWeeks = (date, weeks) => {
            const result = new Date(date);
            result.setDate(result.getDate() + weeks * 7);
            return result;
        };

        const escapeHtml = (str) => {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        };

        const isValidLink = (url) => {
            try { return new URL(url).protocol === 'https:'; }
            catch { return false; }
        };

        class ScheduleApp {
            constructor() {
                this.weekOffset = 0;
                this.dom = {
                    dateDisplay: document.getElementById('dateDisplay'),
                    schedule: document.getElementById('schedule'),
                    weekNumber: document.getElementById('weekNumber'),
                    prevBtn: document.getElementById('prevBtn'),
                    nextBtn: document.getElementById('nextBtn'),
                    resetBtn: document.getElementById('resetBtn')
                };
                this.init();
            }

            init() {
                this.dom.prevBtn.addEventListener('click', () => this.navigate(-1));
                this.dom.nextBtn.addEventListener('click', () => this.navigate(1));
                this.dom.resetBtn.addEventListener('click', () => this.reset());
                document.addEventListener('keydown', (e) => this.handleKey(e));
                this.render();
            }

            handleKey(e) {
                if (e.target.closest('input, textarea')) return;
                const actions = { ArrowLeft: -1, ArrowRight: 1, Home: 0 };
                if (e.key in actions) {
                    e.preventDefault();
                    e.key === 'Home' ? this.reset() : this.navigate(actions[e.key]);
                }
            }

            getWeekInfo(offset = 0) {
                const date = addWeeks(new Date(), this.weekOffset + offset);
                const week = getAcademicWeek(date);
                return { date, week, type: week % 2 === 0 ? 'even' : 'odd' };
            }

            navigate(dir) {
                const { week } = this.getWeekInfo(dir);
                if (week >= CONFIG.MIN_WEEK && week <= CONFIG.MAX_WEEK) {
                    this.weekOffset += dir;
                    this.render();
                }
            }

            reset() {
                if (this.weekOffset !== 0) {
                    this.weekOffset = 0;
                    this.render();
                }
            }

            render() {
                const { date, week, type } = this.getWeekInfo();
                const prev = this.getWeekInfo(-1);
                const next = this.getWeekInfo(1);

                this.dom.dateDisplay.textContent = date.toLocaleDateString('ru-RU', {
                    weekday: 'short', day: 'numeric', month: 'numeric', year: 'numeric'
                });
                this.dom.weekNumber.textContent = week;
                this.dom.prevBtn.disabled = prev.week < CONFIG.MIN_WEEK;
                this.dom.nextBtn.disabled = next.week > CONFIG.MAX_WEEK;
                this.dom.resetBtn.disabled = this.weekOffset === 0;

                this.dom.schedule.classList.add('schedule--loading');
                setTimeout(() => {
                    this.renderSchedule(SCHEDULE[type] || {});
                    this.dom.schedule.classList.remove('schedule--loading');
                }, 150);
            }

            renderSchedule(schedule) {
                const today = new Date();
                const todayName = this.weekOffset === 0 ? CONFIG.DAYS[(today.getDay() + 6) % 7] : null;

                const html = CONFIG.DAYS
                    .filter(day => schedule[day]?.length)
                    .map(day => this.createDayCard(day, schedule[day], day === todayName))
                    .join('');

                this.dom.schedule.innerHTML = html || `
                    <div class="empty-state">
                        <div class="empty-state__emoji">üìö</div>
                        <h2 class="empty-state__title">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</h2>
                        <p class="empty-state__text">–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –ø–∞—Ä –Ω–µ—Ç</p>
                    </div>`;
            }

            createDayCard(day, lessons, isToday) {
                return `
                    <article class="day-card ${isToday ? 'day-card--today' : ''}" id="day-${day}">
                        <h2 class="day-card__header">${escapeHtml(day)}</h2>
                        ${lessons.map(l => this.createLesson(l)).join('')}
                    </article>`;
            }

            createLesson({ time, name, type, teacher, link }) {
                const hasLink = link && isValidLink(link);
                const tag = hasLink ? 'a' : 'div';
                const attrs = hasLink ? `href="${escapeHtml(link)}" target="_blank" rel="noopener"` : '';

                return `
                    <${tag} class="lesson" ${attrs}>
                        <div class="lesson__time">
                            <svg class="lesson__icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                            </svg>
                            <time>${escapeHtml(time)}</time>
                        </div>
                        <h3 class="lesson__title">${escapeHtml(name)}</h3>
                        <div class="lesson__meta">
                            <span class="lesson__tag">${escapeHtml(type)}</span>
                            <span class="lesson__teacher">${escapeHtml(teacher)}</span>
                        </div>
                    </${tag}>`;
            }
        }

        new ScheduleApp();
    </script>
</body>
</html>
