<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1d1d1d">
    <meta name="description" content="Расписание МКНм-241">
    <title>Расписание</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@200;300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-base: #1d1d1d;
            --text-main: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.6);
            --accent-indigo: #4b0082;
            --accent-green: #10893e;
            --accent-blue: #2b5797;
            --accent-orange: #da532c;
            --accent-red: #b91d47;
            --accent-teal: #00aba9;
            --ease-win: cubic-bezier(0.1, 0.9, 0.2, 1);
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-base);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
            cursor: default;
        }

        .header {
            padding: 40px 40px 20px 40px;
            animation: slideIn 0.6s var(--ease-win);
            flex-shrink: 0;
        }

        .header__title {
            font-weight: 200;
            font-size: 3.8rem;
            line-height: 1;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .header__subtitle {
            font-size: 1.1rem;
            color: var(--text-muted);
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-left: 2px;
        }

        .scroll-container {
            flex-grow: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 10px 40px 100px 40px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .scroll-container::-webkit-scrollbar {
            display: none;
        }

        .masonry-layout {
            column-width: 360px;
            column-gap: 12px;
            width: 100%;
            max-width: 1920px;
        }

        .tile {
            break-inside: avoid;
            display: inline-block;
            width: 100%;
            margin-bottom: 12px;
            background-color: #333;
            position: relative;
            animation: popIn 0.5s var(--ease-win) backwards;
            vertical-align: top;
            transition: transform 0.1s linear;
        }

        .tile:nth-child(1) { background-color: var(--accent-indigo); animation-delay: 0.05s; }
        .tile:nth-child(2) { background-color: var(--accent-green); animation-delay: 0.1s; }
        .tile:nth-child(3) { background-color: var(--accent-red); animation-delay: 0.15s; }
        .tile:nth-child(4) { background-color: var(--accent-blue); animation-delay: 0.2s; }
        .tile:nth-child(5) { background-color: var(--accent-orange); animation-delay: 0.25s; }
        .tile:nth-child(6) { background-color: var(--accent-teal); animation-delay: 0.3s; }

        .tile:active {
            transform: scale(0.97);
        }

        .tile--today {
            box-shadow: 0 0 0 4px rgba(255,255,255,0.3);
            z-index: 2;
        }

        .tile__header {
            padding: 12px 20px;
            font-size: 1.5rem;
            font-weight: 300;
            line-height: 1.2;
        }

        .tile__body {
            display: flex;
            flex-direction: column;
        }

        .lesson {
            display: grid;
            grid-template-columns: 72px 1fr;
            text-decoration: none;
            color: inherit;
            border-top: 1px solid rgba(255,255,255,0.15);
            position: relative;
            min-height: 72px;
        }

        a.lesson:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .lesson__time-box {
            padding: 14px 0 14px 20px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            border-right: 1px solid rgba(255,255,255,0.2);
        }

        .lesson__start {
            font-size: 1.05rem;
            font-weight: 600;
            line-height: 1;
            letter-spacing: 0.02em;
        }

        .lesson__end {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 4px;
            font-weight: 400;
        }

        .lesson__info {
            padding: 12px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .lesson__title {
            font-size: 1.05rem;
            font-weight: 600;
            line-height: 1.25;
            margin-bottom: 2px;
        }

        .lesson__details {
            font-size: 0.8rem;
            opacity: 0.75;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.03em;
        }
        
        .app-bar {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: 80px;
            background: #1f1f1f;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            z-index: 100;
            border-top: 1px solid #333;
            animation: slideUp 0.4s 0.2s var(--ease-win) backwards;
        }

        .nav-btn {
            background: transparent;
            border: 2px solid #ffffff;
            color: #ffffff;
            width: 46px; height: 46px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.1s, color 0.1s;
        }

        .nav-btn:hover:not(:disabled) {
            background: #ffffff;
            color: #000000;
        }
        
        .nav-btn:active:not(:disabled) {
            transform: scale(0.92);
        }
        
        .nav-btn:disabled {
            border-color: #555;
            color: #555;
        }

        .nav-btn svg {
            width: 16px;
            height: 16px;
            stroke-width: 2.5;
        }

        .week-display {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #888;
            min-width: 80px;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .week-display .val {
            font-size: 1.8rem;
            color: #fff;
            font-weight: 200;
            line-height: 1;
            margin-top: 4px;
        }

        .empty-state {
            padding: 40px;
            color: #666;
            font-size: 1.8rem;
            font-weight: 200;
        }

        @keyframes slideIn { from { opacity: 0; transform: translateX(40px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        @media (max-width: 600px) {
            .header { padding: 30px 24px 10px 24px; }
            .header__title { font-size: 3rem; }
            .scroll-container { padding: 10px 16px 90px 16px; }
            .masonry-layout { column-width: 100%; } 
            .lesson { grid-template-columns: 70px 1fr; }
            .app-bar { height: 70px; gap: 20px; }
            .nav-btn { width: 40px; height: 40px; }
        }
    </style>
</head>
<body>

    <header class="header">
        <h1 class="header__title" id="dateTitle">Start</h1>
        <div class="header__subtitle" id="dateSubtitle">Расписание</div>
    </header>

    <div class="scroll-container">
        <main class="masonry-layout" id="schedule">
        </main>
    </div>

    <nav class="app-bar">
        <button class="nav-btn" id="prevBtn" aria-label="Назад">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="square" d="M15 19l-7-7 7-7"/></svg>
        </button>
        
        <div class="week-display">
            <span>НЕДЕЛЯ</span>
            <span class="val" id="weekNumber">--</span>
        </div>

        <button class="nav-btn" id="nextBtn" aria-label="Вперед">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="square" d="M9 5l7 7-7 7"/></svg>
        </button>
    </nav>

<script>
    const CONFIG = Object.freeze({
        MIN_WEEK: 20,
        MAX_WEEK: 39,
        SEMESTER_START: Object.freeze({ month: 8, day: 1 }),
        DAYS: Object.freeze(['Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота']),
        MS_PER_WEEK: 604800000
    });

    const SCHEDULE = Object.freeze({
        odd: Object.freeze({
            'Среда': [
                { time: '15:30 – 17:05', name: 'Современные численные методы', type: 'Практика', teacher: 'Гудов А.М.', link: 'https://bbb.kemsu.ru/b/nt9-332-k4x-2pe' },
                { time: '17:15 – 18:50', name: 'Анализ безопасности веб-приложений', type: 'Лекция', teacher: 'Саблинский А.И.' },
                { time: '19:00 – 20:35', name: 'Анализ безопасности веб-приложений', type: 'Лабораторная', teacher: 'Саблинский А.И.' }
            ]
        }),
        even: Object.freeze({
            'Среда': [
                { time: '15:30 – 17:05', name: 'Современные численные методы', type: 'Практика', teacher: 'Гудов А.М.', link: 'https://bbb.kemsu.ru/b/nt9-332-k4x-2pe' }
            ],
            'Пятница': [
                { time: '17:15 – 18:50', name: 'Математические методы кодирования и криптографии', type: 'Лекция', teacher: 'Сергеева О.А.' },
                { time: '19:00 – 20:35', name: 'Математические методы кодирования и криптографии', type: 'Лабораторная', teacher: 'Сергеева О.А.' }
            ]
        })
    });

    const getAcademicWeek = (date) => {
        const year = date.getMonth() < CONFIG.SEMESTER_START.month ? date.getFullYear() - 1 : date.getFullYear();
        const start = new Date(year, CONFIG.SEMESTER_START.month, CONFIG.SEMESTER_START.day);
        const dayOffset = (start.getDay() + 6) % 7;
        start.setDate(start.getDate() - dayOffset);
        return Math.ceil((date - start) / CONFIG.MS_PER_WEEK);
    };

    const addWeeks = (date, weeks) => {
        const result = new Date(date);
        result.setDate(result.getDate() + weeks * 7);
        return result;
    };

    const parseTime = (timeStr) => {
        const parts = timeStr.split('–').map(s => s.trim());
        return { start: parts[0] || '', end: parts[1] || '' };
    };

    class ScheduleApp {
        constructor() {
            this.weekOffset = 0;
            this.dom = {
                dateTitle: document.getElementById('dateTitle'),
                dateSubtitle: document.getElementById('dateSubtitle'),
                schedule: document.getElementById('schedule'),
                weekNumber: document.getElementById('weekNumber'),
                prevBtn: document.getElementById('prevBtn'),
                nextBtn: document.getElementById('nextBtn')
            };
            this.init();
        }

        init() {
            this.dom.prevBtn.addEventListener('click', () => this.navigate(-1));
            this.dom.nextBtn.addEventListener('click', () => this.navigate(1));
            document.addEventListener('keydown', (e) => {
                if(e.key === 'ArrowLeft') this.navigate(-1);
                if(e.key === 'ArrowRight') this.navigate(1);
            });
            this.render();
        }

        getWeekInfo(dir = 0) {
            const date = addWeeks(new Date(), this.weekOffset + dir);
            const week = getAcademicWeek(date);
            return { date, week, type: week % 2 === 0 ? 'even' : 'odd' };
        }

        navigate(dir) {
            const { week } = this.getWeekInfo(dir);
            if (week >= CONFIG.MIN_WEEK && week <= CONFIG.MAX_WEEK) {
                this.weekOffset += dir;
                this.render();
            }
        }

        render() {
            const { date, week, type } = this.getWeekInfo();
            const prev = this.getWeekInfo(-1);
            const next = this.getWeekInfo(1);

            this.dom.dateTitle.textContent = date.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' });
            this.dom.dateSubtitle.textContent = date.toLocaleDateString('ru-RU', { weekday: 'long' });
            
            this.dom.weekNumber.textContent = week;
            this.dom.prevBtn.disabled = prev.week < CONFIG.MIN_WEEK;
            this.dom.nextBtn.disabled = next.week > CONFIG.MAX_WEEK;
            
            this.renderSchedule(SCHEDULE[type] || {});
        }

        renderSchedule(schedule) {
            const today = new Date();
            const todayName = this.weekOffset === 0 ? CONFIG.DAYS[(today.getDay() + 6) % 7] : null;

            const html = CONFIG.DAYS
                .filter(day => schedule[day]?.length)
                .map(day => this.createTile(day, schedule[day], day === todayName))
                .join('');

            this.dom.schedule.innerHTML = html || `<div class="empty-state">Нет занятий</div>`;
        }

        createTile(day, lessons, isToday) {
            return `
                <article class="tile ${isToday ? 'tile--today' : ''}">
                    <div class="tile__header">${day}</div>
                    <div class="tile__body">
                        ${lessons.map(l => this.createLesson(l)).join('')}
                    </div>
                </article>`;
        }

        createLesson({ time, name, type, teacher, link }) {
            const { start, end } = parseTime(time);
            const isLink = link && link.startsWith('http');
            const tag = isLink ? 'a' : 'div';
            const attrs = isLink ? `href="${link}" target="_blank" rel="noopener"` : '';

            return `
                <${tag} class="lesson" ${attrs}>
                    <div class="lesson__time-box">
                        <span class="lesson__start">${start}</span>
                        <span class="lesson__end">${end}</span>
                    </div>
                    <div class="lesson__info">
                        <div class="lesson__title">${name}</div>
                        <div class="lesson__details">
                            <span class="tag-type">${type}</span>
                            <span style="margin: 0 5px; opacity: 0.5">•</span>
                            <span class="tag-teacher">${teacher}</span>
                        </div>
                    </div>
                </${tag}>`;
        }
    }

    new ScheduleApp();
</script>
</body> 
</html>
